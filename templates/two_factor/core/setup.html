{% extends "layout.html" %}
{% load i18n %}

{% block content %}
<div class="app-content content">
    <div class="content-wrapper">
        <div class="content-header row">
            <div class="content-header-left col-md-8 col-12 mb-2 breadcrumb-new">
                <h3 class="content-header-title mb-0 d-inline-block">{% block title %}{% trans "Enable Two-Factor Authentication" %}{% endblock %}</h3>
                <div class="row breadcrumbs-top d-inline-block">
                    <div class="breadcrumb-wrapper col-12">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="{% url 'pesaify-dashboard' %}">{% trans 'Dashboard' %}</a>
                            </li>
                            <li class="breadcrumb-item"><a href="{% url 'pesaify-account' %}">{% trans 'Account' %}</a>
                            </li>
                            <li class="breadcrumb-item"><a href="{% url 'two_factor:profile' %}">{% trans 'Two Factor' %}</a>
                            </li>
                            <li class="breadcrumb-item active">{% trans 'Setup' %}
                            </li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
        <div class="content-body">
            {% if not request.user.dismiss_message and request.user.message %}
            <div class="alert alert-dismissable alert-success">
                <button type="button" class="close" data-dismiss="alert" aria-hidden="true" id="dismiss">&times;</button>
                {{ request.user.message|safe }}
            </div>
            {% endif %}
            <div class="row">
              <div class="col-12 col-md-6">
                  <div class="">
                      <div class="card-content collapse show">
                          <div class="card-body">
                            {% if wizard.steps.current == 'welcome' %}
                              <p>{% blocktrans %}You are about to take your account security to the
                                  next level. Follow the steps in this wizard to enable two-factor
                                  authentication.{% endblocktrans %}</p>
                            {% elif wizard.steps.current == 'method' %}
                              <p>{% blocktrans %}Please select which authentication method you would
                                  like to use.{% endblocktrans %}</p>
                            {% elif wizard.steps.current == 'generator' %}
                              <p>{% blocktrans %}To start using a token generator, please use your
                                  smartphone to scan the QR code below. For example, use Google
                                  Authenticator. Then, enter the token generated by the app.
                                  {% endblocktrans %}</p>
                              <p><img src="{{ QR_URL }}" alt="QR Code" /></p>
                            {% elif wizard.steps.current == 'validation' %}
                              {% if challenge_succeeded %}
                              {% else %}
                                <p class="alert alert-warning" role="alert">{% blocktrans %}We've
                                  encountered an issue with the selected authentication method. Please
                                  go back and verify that you entered your information correctly, try
                                  again, or use a different authentication method instead. If the issue
                                  persists, contact the site administrator.{% endblocktrans %}</p>
                              {% endif %}
                            {% endif %}
                            <form action="" method="post">{% csrf_token %}

                              {% include "two_factor/_wizard_forms.html" %}

                              {# hidden submit button to enable [enter] key #}
                              <div style="margin-left: -9999px"><input type="submit" value=""/></div>

                              {% include "two_factor/_wizard_actions.html" %}
                            </form>

                          </div>
                      </div>
                  </div>
              </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
